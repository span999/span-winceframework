

CC = gcc
CCFLAG = -Wall -ansi

AR = ar
ARFLAG = rcs

SERVER = host
CLIENT = client
TESTCILENT = testclient
TCPIPS = tcp-ip 
HELPER = toolhelps
HELPERBIN = libtoolhelps.a
IPCMGR = sysIPCMGR
IPCSRV = sysIPCSRV
IPCSRVBIN = libsysIPCSRV.a
POWERMGR = sysPowerMGR
POWERSRV = sysPowerSRV
POWERSRVBIN = libsysPowerSRV.a
RINGBUF = spRingBuf
RINGBUFBIN = libspRingBuf.a




all: clean HELPER TCPIPS CLIENT SERVER RINGBUF IPCSRV POWERSRV TESTCILENT POWERMGR IPCMGR
	@echo ================================================================

POWERMGR:
	@echo ================================================================
	$(CC) $(CCGLAG) -c ../$(POWERMGR).c
	$(CC) $(CCGLAG) -o $(POWERMGR) $(POWERMGR).o ipcpacket.o -lpthread -L. -l$(HELPER) -l$(IPCSRV)

IPCMGR:
	@echo ================================================================
	$(CC) $(CCGLAG) -c ../$(IPCMGR).c
	$(CC) $(CCGLAG) -o $(IPCMGR) $(IPCMGR).o tcp-server.o ipcpacket.o -L. -l$(HELPER) -l$(IPCSRV)

TESTCILENT:
	@echo ================================================================
	$(CC) $(CCFLAG) -o $(TESTCILENT) ../$(TESTCILENT).c -L. -l$(HELPER) -l$(POWERSRV) -lpthread

POWERSRV:
	@echo ================================================================
	$(CC) $(CCFLAG) -c ../$(POWERSRV).c
	$(AR) $(ARFLAG) $(POWERSRVBIN) $(RINGBUF).o $(IPCSRV).o $(POWERSRV).o ipcpacket.o

IPCSRV:
	@echo ================================================================
	$(CC) $(CCFLAG) -c ../$(IPCSRV).c
	$(AR) $(ARFLAG) $(IPCSRVBIN) $(IPCSRV).o $(RINGBUF).o

RINGBUF:
	@echo ================================================================
	$(CC) $(CCFLAG) -c ../$(RINGBUF).c
	$(AR) $(ARFLAG) $(RINGBUFBIN) $(RINGBUF).o 

SERVER:
	@echo ================================================================
	$(CC) $(CCGLAG) -c ../testrun.c ../main.c
	$(CC) $(CCGLAG) -o $(SERVER) testrun.o tcp-server.o main.o -L. -l$(HELPER)

CLIENT:
	@echo ================================================================
	$(CC) $(CCFLAG) -o $(CLIENT) tcp-client.o -L. -l$(HELPER)

TCPIPS:
	@echo ================================================================
	$(CC) $(CCFLAG) -c ../tcp-server.c
	$(CC) $(CCFLAG) -c ../tcp-client.c
	$(CC) $(CCFLAG) -c ../ipcpacket.c

HELPER:
	@echo ================================================================
	$(CC) $(CCFLAG) -c ../$(HELPER).c
	$(AR) $(ARFLAG) $(HELPERBIN) $(HELPER).o

clean:
	@echo ================================================================
	rm -f $(IPCMGR) $(SERVER) $(CLIENT) *.o *.a


