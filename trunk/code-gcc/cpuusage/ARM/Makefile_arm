
CC	= /home/span/workshop/bin/toolchains/freescale/gcc-4.4.4-glibc-2.11.1-multilib-1.0/arm-fsl-linux-gnueabi/bin/arm-fsl-linux-gnueabi-gcc
AR	= /home/span/workshop/bin/toolchains/freescale/gcc-4.4.4-glibc-2.11.1-multilib-1.0/arm-fsl-linux-gnueabi/bin/arm-fsl-linux-gnueabi-ar
DEFINES =
CFLAGS	= -O2 -I. -L. ${DEFINES} -D__ARM_CODE__


PROGRAM	= cpuusage
DYNLIB  = libtest.so
STATIC1LIB = libcpuutil.a
STATIC1NAME = cpuutil
STATIC2LIB = libframebuffer.a
STATIC2NAME = framebuffer


all: clean PROGRAM


STATIC1LIB:
	@echo 
	@echo ================================================================
	@echo build static ${STATIC1LIB} library
	@echo ----------------------------------------------------------------
	${CC} ${CFLAGS} -c ../${STATIC1NAME}.c
	${AR} rcs ${STATIC1LIB} ${STATIC1NAME}.o

STATIC2LIB:
	@echo 
	@echo ================================================================
	@echo build static ${STATIC2LIB} library
	@echo ----------------------------------------------------------------
	${CC} ${CFLAGS} -c ../${STATIC2NAME}.c
	${AR} rcs ${STATIC2LIB} ${STATIC2NAME}.o


DYNLIB:
	@echo 
	@echo ================================================================
	@echo build dynamic library
	@echo ----------------------------------------------------------------
	${CC} ../so_test.c -fPIC -shared -o ${DYNLIB}

PROGRAM: STATIC1LIB STATIC2LIB
	@echo 
	@echo ================================================================
	@echo build ${PROGRAM} binary.
	@echo ----------------------------------------------------------------
	${CC} ../main.c ${CFLAGS} -o ${PROGRAM} -lpthread -L. -l${STATIC1NAME} -l${STATIC2NAME}
#	${CC} ../main.c ../${STATIC1NAME}.c ${CFLAGS} -o ${PROGRAM} -lpthread

clean:
	@echo 
	@echo ================================================================
	@echo Erasing objects and backup files.
	@echo ----------------------------------------------------------------
	rm -f ${PROGRAM} *.so *.o *.a
