// spCElogEx.c : Defines the entry point for the application.
//


#include <windows.h>
#include "spCElog2txt.h"
#include "spCEbuf.h"
#include "spCElog.h"
#include "spCElogCmdRsp.h"


///
#define SPERR						NKDbgPrintfW
///#define SPDBG						NKDbgPrintfW
#define SPDBG						///void

#define _ASYNC_CONTROL_CHAR 		0x7E /* Flag character value.  Corresponds  to the ~ character                  */
#define _ASYNC_ESC_CHAR     		0x7D /* Escape sequence 1st character value */
#define _ASYNC_ESC_MASK     		0x20 /* Escape sequence complement value    */
#define _ASYNC_TAIL_SIZE    		3    /* CRC plus tail character             */


///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-
static spCElog_Cmd_Mapping	Cmd_Table[] =
	{	
		{  0,  4, {0x1D, 0x1C, 0x3B, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,		         "Timestamp Request\0", { 0x15, 0x00 } },
		{  1,  4, {0x00, 0x78, 0xF0, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,          "Version information Request\0", { 0x43, 0x00 } },
		{  2,  4, {0x7C, 0x93, 0x49, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,         "Get Extended Build ID Request\0", { 0x30, 0x00 } },
		{  3,  4, {0x1C, 0x95, 0x2A, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,     "Diagnostic Protocal Version Request\0", { 0x0F, 0x00 } },
		{  4,  4, {0x0C, 0x14, 0x3A, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,               "DMSS status Request\0", { 0x0E, 0x00 } },
		{  5,  4, {0x63, 0xE5, 0xA1, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0, "get DMSS state/Status Snapshot Request\0", { 0x0E, 0x00 } },
		{  6,  7, {0x4B, 0x04, 0x0E, 0x00, 0x0D, 0xD3, 0x7E, 0x00, 0x00, 0x00},  0,               "Regular device polling\0", { 0x00, 0x00 } },
		{  7,  7, {0x4B, 0x0F, 0x00, 0x00, 0xBB, 0x60, 0x7E, 0x00, 0x00, 0x00},  0,        "Call Manager/state Info Request\0", { 0x3C, 0x00 } },
		{  8,  7, {0x4B, 0x09, 0x00, 0x00, 0x62, 0xB6, 0x7E, 0x00, 0x00, 0x00},  0,              "UMTS/Version Request\0", { 0x26, 0x00 } },
		{  9,  7, {0x4B, 0x08, 0x00, 0x00, 0xBE, 0xEC, 0x7E, 0x00, 0x00, 0x00},  0,               "GSM/Version Request\0", { 0x16, 0x00 } },
		{ 10,  7, {0x4B, 0x08, 0x01, 0x00, 0x66, 0xF5, 0x7E, 0x00, 0x00, 0x00},  0,                "GSM/Status Request\0", { 0x2C, 0x00 } },
		{ 11,  7, {0x4B, 0x04, 0x00, 0x00, 0x1D, 0x49, 0x7E, 0x00, 0x00, 0x00},  0,             "WCDMA/Version Request\0", { 0x16, 0x00 } },
		{ 12,  7, {0x4B, 0x04, 0x0F, 0x00, 0xD5, 0xCA, 0x7E, 0x00, 0x00, 0x00},  0,      "WCDMA/Additional Status Request\0", { 0x23, 0x00 } },
		{ 13,  5, {0x60, 0x00, 0x12, 0x6A, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00},  0,       "Event Report Control Request:00\0", { 0x0F, 0x00 } },
		{ 14,  5, {0x60, 0x01, 0x9B, 0x7B, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00},  0,       "Event Report Control Request:01\0", { 0x0F, 0x00 } },
///		{ 15,  5, {0x60, 0x00, 0x12, 0x6A, 0x7E, 0x00, 0x00},  0,          "Event Report Control Request\0", { 0x00, 0x00 } },
///		{ 15,  1, {0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,               "Logging config Request\0", { 0xA7, 0x00 } },
		{ 15,  5, {0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,               "Logging config Request\0", { 0xA7, 0x00 } },
///		{ 16,  2, {0x7D, 0x5D, 0x00, 0x00, 0x00, 0x00, 0x00},  0,     "Extended Msg report config Request\0", { 0x00, 0x00 } },
		{ 16,  7, {0x7D, 0x5D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,     "Extended Msg report config Request\0", { 0x00, 0x00 } },
		{ 17,  1, {0x82, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,              "Set Event Mask Request\0", { 0x1A, 0x01 } },
		{ 18,  4, {0x4B, 0x13, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "EFS2/DIAG Open Request\0", { 0x18, 0x00 } },
		{ 19, 10, {0x4B, 0x13, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06},  0,            "EFS2/DIAG Write Request6\0", { 0x20, 0x00 } },
		{ 20, 10, {0x4B, 0x13, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08},  0,            "EFS2/DIAG Write Request8\0", { 0x20, 0x00 } },
		{ 21,  4, {0x4B, 0x13, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "EFS2/DIAG Write Request\0", { 0x20, 0x00 } },
		{ 22,  4, {0x4B, 0x13, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "EFS2/DIAG Close Request\0", { 0x14, 0x00 } },
		{ 23,  9, {0x73, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x01, 0x00},  0,             "Logging config Request 1\0", { 0xA7, 0x00 } },
		{ 24,  9, {0x73, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x04, 0x00},  0,             "Logging config Request 2\0", { 0x43, 0x01 } },
		{ 25,  9, {0x73, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x05, 0x00},  0,             "Logging config Request 3\0", { 0xA5, 0x00 } },
		{ 26,  9, {0x73, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x07, 0x00},  0,             "Logging config Request 4\0", { 0xC0, 0x00 } },
		{ 27,  9, {0x73, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x0B, 0x00},  0,             "Logging config Request 5\0", { 0x21, 0x00 } },
		{ 28,  7, {0x7D, 0x5D, 0x04, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request 1\0", { 0xEC, 0x00 } },
		{ 29,  7, {0x7D, 0x5D, 0x04, 0xF4, 0x01, 0xFA, 0x01, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request 2\0", { 0x30, 0x00 } },
		{ 30,  7, {0x7D, 0x5D, 0x04, 0xB8, 0x0B, 0xC4, 0x0B, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request 3\0", { 0x48, 0x00 } },
		{ 31,  7, {0x7D, 0x5D, 0x04, 0xA0, 0x0F, 0xAA, 0x0F, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request 4\0", { 0x40, 0x00 } },
		{ 32,  7, {0x7D, 0x5D, 0x04, 0x88, 0x13, 0x9A, 0x13, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request 5\0", { 0x60, 0x00 } },
		{ 33,  7, {0x7D, 0x5D, 0x04, 0x7C, 0x15, 0x8A, 0x15, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request 6\0", { 0x50, 0x00 } },
		{ 34,  7, {0x7D, 0x5D, 0x04, 0x70, 0x17, 0xA2, 0x17, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request 7\0", { 0xE0, 0x00 } },
		{ 35,  7, {0x7D, 0x5D, 0x04, 0x64, 0x19, 0x79, 0x19, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request 8\0", { 0x6C, 0x00 } },
		{ 36,  7, {0x7D, 0x5D, 0x04, 0x58, 0x1B, 0x5B, 0x1B, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request 9\0", { 0x24, 0x00 } },
		{ 37,  7, {0x7D, 0x5D, 0x04, 0xBC, 0x1B, 0xC7, 0x1B, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request A\0", { 0x44, 0x00 } },
		{ 38,  7, {0x7D, 0x5D, 0x04, 0x20, 0x1C, 0x21, 0x1C, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request B\0", { 0x1C, 0x00 } },
		{ 39,  7, {0x7D, 0x5D, 0x04, 0x28, 0x23, 0x30, 0x23, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request C\0", { 0x38, 0x00 } },
		{ 40,  8, {0x73, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00},  0, "Logging config Request -supported equipment IDs-\0", { 0x21, 0x00 } },
		{ 41,  3, {0x7D, 0x5D, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0, "Extended Msg report config Request -supported SSID-\0", { 0xEC, 0x00 } },
		{ 42,  4, {0x81, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,              "Get Event Mask Request\0", { 0x1A, 0x01 } },
		{ 43,  4, {0x4B, 0x13, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "EFS2/Query  Request\0", { 0x18, 0x00 } },
		{ 44,  4, {0x4B, 0x13, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "EFS2/Hello  Request\0", { 0x18, 0x00 } },
		{ 45,  7, {0x7D, 0x5D, 0x02, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 46,  7, {0x7D, 0x5D, 0x02, 0xF4, 0x01, 0xFA, 0x01, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 47,  7, {0x7D, 0x5D, 0x02, 0xB8, 0x0B, 0xC4, 0x0B, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 48,  7, {0x7D, 0x5D, 0x02, 0xA0, 0x0F, 0xAA, 0x0F, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 49,  7, {0x7D, 0x5D, 0x02, 0x88, 0x13, 0x9A, 0x13, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 50,  7, {0x7D, 0x5D, 0x02, 0x7C, 0x15, 0x8A, 0x15, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 51,  7, {0x7D, 0x5D, 0x02, 0x70, 0x17, 0xA2, 0x17, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 52,  7, {0x7D, 0x5D, 0x02, 0x64, 0x19, 0x79, 0x19, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 53,  7, {0x7D, 0x5D, 0x02, 0x58, 0x1B, 0x5B, 0x1B, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 54,  7, {0x7D, 0x5D, 0x02, 0xBC, 0x1B, 0xC7, 0x1B, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 55,  7, {0x7D, 0x5D, 0x02, 0x20, 0x1C, 0x21, 0x1C, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ 56,  7, {0x7D, 0x5D, 0x02, 0x28, 0x23, 0x30, 0x23, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Request -\0", { 0x24, 0x00 } },
		{ -1,  0, {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,          "----------------------------------\0", { 0x00, 0x00 } }
	};

static spCElog_Rsp_Mapping	Rsp_Table[] =
	{	
		{  0,  8, {0x4B, 0x04, 0x0E, 0x00, 0x01, 0xC7, 0x3A, 0x7E, 0x00, 0x00},  0,               "Regular device polling\0", { 0x00, 0x00 } },
		{  1,  1, {0x1D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,		          "Timestamp Response\0", { 0x0D, 0x00 } },
		{  2,  1, {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,		    "Version information Response\0", { 0x0D, 0x00 } },
		{  3,  1, {0x7C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,	       "Get Extended Build ID Response\0", { 0x0D, 0x00 } },
		{  4,  1, {0x1C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,	   "Diagnostic Protocal Version Response\0", { 0x0D, 0x00 } },
		{  5,  1, {0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,	             "DMSS status Response\0", { 0x0D, 0x00 } },
		{  6,  1, {0x63, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,"get DMSS state/Status Snapshot Response\0", { 0x10, 0x00 } },
		{  7,  2, {0x13, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,       "Invalid command error Response\0", { 0x0D, 0x00 } },
		{  8,  2, {0x13, 0x63, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,       "Invalid command error Response\0", { 0x10, 0x00 } },
		{  9,  4, {0x4B, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,      "Call Manager/state Info Response\0", { 0x10, 0x00 } },
		{ 10,  4, {0x4B, 0x09, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "UMTS/Version Response\0", { 0x10, 0x00 } },
		{ 11,  4, {0x4B, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,              "GSM/Version Response\0", { 0x10, 0x00 } },
		{ 12,  4, {0x4B, 0x08, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,               "GSM/Status Response\0", { 0x10, 0x00 } },
		{ 13,  4, {0x4B, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,            "WCDMA/Version Response\0", { 0x10, 0x00 } },
		{ 14,  4, {0x4B, 0x04, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,"WCDMA/Additional Status Request Response\0", { 0x0E, 0x00 } },
		{ 15,  2, {0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,         "Event Report Control Response\0", { 0x1A, 0x01 } },
		{ 16,  1, {0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "Logging config Response\0", { 0x3F, 0x01 } },
///		{ 17,  2, {0x7D, 0x5D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response\0", { 0x00, 0x00 } },
		{ 17,  7, {0x7D, 0x5D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response\0", { 0x00, 0x00 } },
		{ 18,  1, {0x82, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "Set Event Mask Response\0", { 0x20, 0x00 } },
		{ 19,  4, {0x4B, 0x13, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,            "EFS2/DIAG Open Response\0", { 0x18, 0x02 } },
		{ 20,  4, {0x4B, 0x13, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,            "EFS2/DIAG Write Response\0", { 0x18, 0x02 } },
		{ 21,  4, {0x4B, 0x13, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,            "EFS2/DIAG Close Response\0", { 0x1C, 0x00 } },
		{ 22,  1, {0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,                   "EVENT Response\0", { 0x00, 0x00 } },
		{ 23,  9, {0x73, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x01, 0x00},  0,            "Logging config Response 1\0", { 0x3F, 0x01 } },
		{ 24,  9, {0x73, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x04, 0x00},  0,            "Logging config Response 2\0", { 0xA1, 0x00 } },
		{ 25,  9, {0x73, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x05, 0x00},  0,            "Logging config Response 3\0", { 0xBD, 0x00 } },
		{ 26,  9, {0x73, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x07, 0x00},  0,            "Logging config Response 4\0", { 0x1E, 0x00 } },
		{ 27,  9, {0x73, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x0B, 0x00},  0,            "Logging config Response 5\0", { 0xEC, 0x00 } },
		{ 28,  7, {0x7D, 0x5D, 0x04, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response 1\0", { 0x30, 0x00 } },
		{ 29,  7, {0x7D, 0x5D, 0x04, 0xF4, 0x01, 0xFA, 0x01, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response 2\0", { 0x48, 0x00 } },
		{ 30,  7, {0x7D, 0x5D, 0x04, 0xB8, 0x0B, 0xC4, 0x0B, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response 3\0", { 0x40, 0x00 } },
		{ 31,  7, {0x7D, 0x5D, 0x04, 0xA0, 0x0F, 0xAA, 0x0F, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response 4\0", { 0x60, 0x00 } },
		{ 32,  7, {0x7D, 0x5D, 0x04, 0x88, 0x13, 0x9A, 0x13, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response 5\0", { 0x50, 0x00 } },
		{ 33,  7, {0x7D, 0x5D, 0x04, 0x7C, 0x15, 0x8A, 0x15, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response 6\0", { 0xE0, 0x00 } },
		{ 34,  7, {0x7D, 0x5D, 0x04, 0x70, 0x17, 0xA2, 0x17, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response 7\0", { 0x6C, 0x00 } },
		{ 35,  7, {0x7D, 0x5D, 0x04, 0x64, 0x19, 0x79, 0x19, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response 8\0", { 0x24, 0x00 } },
		{ 36,  7, {0x7D, 0x5D, 0x04, 0x58, 0x1B, 0x5B, 0x1B, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response 9\0", { 0x44, 0x00 } },
		{ 37,  7, {0x7D, 0x5D, 0x04, 0xBC, 0x1B, 0xC7, 0x1B, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response A\0", { 0x1C, 0x00 } },
		{ 38,  7, {0x7D, 0x5D, 0x04, 0x20, 0x1C, 0x21, 0x1C, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response B\0", { 0x38, 0x00 } },
		{ 39,  7, {0x7D, 0x5D, 0x04, 0x28, 0x23, 0x30, 0x23, 0x00, 0x00, 0x00},  0,   "Extended Msg report config Response C\0", { 0x0E, 0x00 } },
		{ 40, 10, {0x4B, 0x13, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06},  0,            "EFS2/DIAG Write Response\0", { 0x70, 0x00 } },
		{ 41, 10, {0x4B, 0x13, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08},  0,            "EFS2/DIAG Write Response\0", { 0x14, 0x00 } },
		{ 42,  2, {0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,         "Event Report Control Response\0", { 0xA4, 0x00 } },
		{ 43,  2, {0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,         "Event Report Control Response\0", { 0x1A, 0x01 } },
		{ 44,  9, {0x73, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00},  0, "Logging config Response -supported equipment IDs-\0", { 0xEC, 0x00 } },
		{ 45,  3, {0x7D, 0x5D, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0, "Extended Msg report config Response -supported SSID-\0", { 0xEC, 0x00 } },
		{ 46,  4, {0x81, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "Get Event Mask Response\0", { 0x20, 0x00 } },
		{ 47,  4, {0x4B, 0x13, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "EFS2/Query  Response\0", { 0x18, 0x00 } },
		{ 48,  4, {0x4B, 0x13, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,             "EFS2/Hello  Response\0", { 0x18, 0x00 } },
		{ 49,  7, {0x7D, 0x5D, 0x02, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 50,  7, {0x7D, 0x5D, 0x02, 0xF4, 0x01, 0xFA, 0x01, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 51,  7, {0x7D, 0x5D, 0x02, 0xB8, 0x0B, 0xC4, 0x0B, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 52,  7, {0x7D, 0x5D, 0x02, 0xA0, 0x0F, 0xAA, 0x0F, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 53,  7, {0x7D, 0x5D, 0x02, 0x88, 0x13, 0x9A, 0x13, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 54,  7, {0x7D, 0x5D, 0x02, 0x7C, 0x15, 0x8A, 0x15, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 55,  7, {0x7D, 0x5D, 0x02, 0x70, 0x17, 0xA2, 0x17, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 56,  7, {0x7D, 0x5D, 0x02, 0x64, 0x19, 0x79, 0x19, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 57,  7, {0x7D, 0x5D, 0x02, 0x58, 0x1B, 0x5B, 0x1B, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 58,  7, {0x7D, 0x5D, 0x02, 0xBC, 0x1B, 0xC7, 0x1B, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 59,  7, {0x7D, 0x5D, 0x02, 0x20, 0x1C, 0x21, 0x1C, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 60,  7, {0x7D, 0x5D, 0x02, 0x28, 0x23, 0x30, 0x23, 0x00, 0x00, 0x00},  0,    "Extended Msg report config Response -\0", { 0x24, 0x00 } },
		{ 61,  2, {0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,                      "LOG Response\0", { 0x24, 0x00 } },
		{ 62,  2, {0x79, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,                      "MSG Response\0", { 0x24, 0x00 } },
		{ -1,  0, {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  0,          "----------------------------------\0", { 0x00, 0x00 } }
	};

	
static UCHAR		ucUnknowDescription[128] = "Unknow Command/Response description\0";

static DWORD		dwLastCmdIdx = 0;
static DWORD		dwLastRspIdx = 0;

///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-




///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-///-
BOOL Is_This_Cmd( BYTE* pData, DWORD dwDataLen, DWORD dwCmdIdx )
{
	BOOL bRet = TRUE;
	DWORD dwCnt = 0;
	BYTE* pTable = NULL;
	
	if( (NULL != pData) && (0 != dwDataLen) )
	{
		pTable = Cmd_Table[dwCmdIdx].bCmd;
		
		while( dwCnt < Cmd_Table[dwCmdIdx].dwCmdLen )
		{
			if( *pData != *pTable )
			{
				bRet = FALSE;
				break;
			}	
			
			dwCnt++;
			pData++;
			pTable++;
		}		
	}
	
	return bRet;
}

BOOL Is_Polling_Cmd( BYTE* pData, DWORD dwDataLen )
{
	return Is_This_Cmd( pData, dwDataLen, 6 );
}

BOOL Is_ExtMsgReportCfg_Cmd( BYTE* pData, DWORD dwDataLen )
{
	return Is_This_Cmd( pData, dwDataLen, 16 );
}

BOOL Is_ExtMsgReportCfg6_Cmd( BYTE* pData, DWORD dwDataLen )
{
	return Is_This_Cmd( pData, dwDataLen, 33 );
}

BOOL Is_Report_Control_On_Cmd( BYTE* pData, DWORD dwDataLen )
{
	return Is_This_Cmd( pData, dwDataLen, 14 );
}

BOOL Is_TimeStamp_Request_Cmd( BYTE* pData, DWORD dwDataLen )
{
	return Is_This_Cmd( pData, dwDataLen, 0 );
}

BOOL Is_This_Rsp( BYTE* pData, DWORD dwDataLen, DWORD dwRspIdx )
{
	BOOL bRet = TRUE;
	DWORD dwCnt = 0;
	BYTE* pTable = NULL;
	
	if( (NULL != pData) && (0 != dwDataLen) )
	{
		pTable = Rsp_Table[dwRspIdx].bRsp;
		
		while( dwCnt < Rsp_Table[dwRspIdx].dwRspLen )
		{
			if( *pData != *pTable )
			{
				bRet = FALSE;
				break;
			}	
			
			dwCnt++;
			pData++;
			pTable++;
		}		
	}
	
	return bRet;
}

BOOL Is_Polling_Rsp( BYTE* pData, DWORD dwDataLen )
{
	return Is_This_Rsp( pData, dwDataLen, 0 );
}

BOOL Is_EVENT_Rsp( BYTE* pData, DWORD dwDataLen )
{
	BOOL bRet = FALSE;
	
	bRet = Is_This_Rsp( pData, dwDataLen, 22 );
	if( bRet )
	{	
		if( 0x00 == *(pData+1) )	///it's aEvent Report Control Response! not EVENT!!
			bRet = FALSE;			///0x60 0x00
		else
		{
			bRet = TRUE;			///0x60 0x??
			SPDBG( TEXT("SPD@Is_EVENT_Rsp: Is EVENT !!![0x%02x][0x%02x]\r\n"), *pData, *(pData+1) );
		}
			
	}
	
	return bRet;
}

BOOL Is_LOG_Rsp( BYTE* pData, DWORD dwDataLen )
{
	BOOL bRet = FALSE;
	
	bRet = Is_This_Rsp( pData, dwDataLen, 61 );
	
	return bRet;
}

BOOL Is_MSG_Rsp( BYTE* pData, DWORD dwDataLen )
{
	BOOL bRet = FALSE;
	
	bRet = Is_This_Rsp( pData, dwDataLen, 62 );
	
	return bRet;
}

BOOL Is_ExtMsgReportCfg_Rsp( BYTE* pData, DWORD dwDataLen )
{
	return Is_This_Rsp( pData, dwDataLen, 17 );
}

BOOL Is_TimeStamp_Request_Rsp( BYTE* pData, DWORD dwDataLen )
{
	return Is_This_Rsp( pData, dwDataLen, 1 );
}


BOOL Is_Stream_Match( BYTE* pData, BYTE* pTable, DWORD dwLenByte )
{
	BOOL bRet = TRUE;
	DWORD dwCnt = 0;
	
	while( dwCnt < dwLenByte )
	{
		if( *pData != *pTable )
		{
			bRet = FALSE;
			break;
		}	
			
		dwCnt++;
		pData++;
		pTable++;
	}
	
	return bRet;	
}

BOOL Is_Cmd_Match( BYTE* pData, BYTE* bCmd, DWORD dwLen )
{
	BOOL bRet = FALSE;
	
	bRet = Is_Stream_Match( pData, bCmd, dwLen );
	
	return bRet;
}

BOOL Is_Rsp_Match( BYTE* pData, BYTE* bCmd, DWORD dwLen )
{
	BOOL bRet = FALSE;
	
	bRet = Is_Stream_Match( pData, bCmd, dwLen );
	
	return bRet;
}


spCElog_Cmd_Mapping* Get_Cmd_Index( DWORD dwIdx )
{
	spCElog_Cmd_Mapping* mRet = NULL;

	
	return mRet;
}


UCHAR* Find_Cmd_Descript( BYTE* pData, DWORD dwLen )
{
	UCHAR* pDescript = NULL;
	DWORD dwTmp = 0;
	DWORD dwThisCmdIdx = 0;
	

	if( dwLen > 128 || dwLen < 3 )
		goto EXIT_FIND_CMD_DESCRIP;

	///find in command table
	do{
	
		///if( dwLen == Cmd_Table[dwTmp].dwCmdLen )
		if( dwLen >= Cmd_Table[dwTmp].dwCmdLen )
		{
			//if( Is_Cmd_Match( pData, Cmd_Table[dwTmp].bCmd, dwLen ) )
			if( Is_Cmd_Match( pData, Cmd_Table[dwTmp].bCmd, Cmd_Table[dwTmp].dwCmdLen ) )
			{
				pDescript = Cmd_Table[dwTmp].ucName;
				break;
			}
		}
		dwTmp++;
	}while( -1 != Cmd_Table[dwTmp].dwIndex );

EXIT_FIND_CMD_DESCRIP:
	
	if( NULL == pDescript )
		pDescript = ucUnknowDescription;
		
	return pDescript;
}

UCHAR* Find_Rsp_Descript( BYTE* pData, DWORD dwLen )
{
	UCHAR* pDescript = NULL;
	DWORD dwTmp = 0;
	DWORD dwThisCmdIdx = 0;
	

	if( dwLen > 777 || dwLen < 3 )
		goto EXIT_FIND_RSP_DESCRIP;

	///find in command table
	do{
	
		///if( dwLen == Cmd_Table[dwTmp].dwCmdLen )
		if( dwLen >= Rsp_Table[dwTmp].dwRspLen )
		{
			//if( Is_Cmd_Match( pData, Cmd_Table[dwTmp].bCmd, dwLen ) )
			if( Is_Rsp_Match( pData, Rsp_Table[dwTmp].bRsp, Rsp_Table[dwTmp].dwRspLen ) )
			{
				pDescript = Rsp_Table[dwTmp].ucName;
				break;
			}
		}
		dwTmp++;
	}while( -1 != Rsp_Table[dwTmp].dwIndex );

EXIT_FIND_RSP_DESCRIP:
	
	if( NULL == pDescript )
		pDescript = ucUnknowDescription;
		
	return pDescript;
}

BOOL Copy_Stream_Without_ESC_code( PBYTE pbTarget, PBYTE pbSource, PDWORD pdwLen )
{
	BOOL 	bRet = TRUE;
	DWORD 	dwCount = 0;
	DWORD	dwESCcnt = 0;
	DWORD	dwLen = 0;
	
	dwLen = *pdwLen;
	
	///check each byte...
	for( dwCount = 0; dwCount < dwLen; dwCount++ )
	{
		///SPDBG( TEXT("SPD@Copy_Stream_Without_ESC_code: %d < %d \r\n"), dwCount, dwLen );
		if( _ASYNC_ESC_CHAR == *pbSource )
		{
			pbSource++;	///move next
			dwCount++;
			dwESCcnt++;
			*pbTarget = ((*pbSource)^_ASYNC_ESC_MASK);
		}
		else	///just copy it
		{
			*pbTarget = *pbSource;
		}
		
		pbSource++;
		pbTarget++;
	}
	
	*pdwLen = *pdwLen - dwESCcnt;
	///SPDBG( TEXT("SPD@Copy_Stream_Without_ESC_code: %d \r\n"), *pdwLen );
	return bRet;
}


UCHAR* Find_Cmd_Chksum( BYTE* pData, DWORD dwLen )
{
	UCHAR* pDescript = NULL;
	DWORD dwTmp = 0;
	DWORD dwThisCmdIdx = 0;
	

	if( dwLen > 777 || dwLen < 3 )
		goto EXIT_FIND_CMD_DESCRIP;

	///find in command table
	do{
		///if( dwLen == Cmd_Table[dwTmp].dwCmdLen )
		if( dwLen >= Cmd_Table[dwTmp].dwCmdLen )
		{
			///if( Is_Cmd_Match( pData, Cmd_Table[dwTmp].bCmd, dwLen ) )
			///if( Is_Cmd_Match( pData, Cmd_Table[dwTmp].bCmd, Cmd_Table[dwTmp].dwCmdLen ) )
			///for DLF,  we already take ESC code off
			DWORD dwCmdLen = 0;
			BYTE  bCmd[10];
			
			dwCmdLen = Cmd_Table[dwTmp].dwCmdLen;
			Copy_Stream_Without_ESC_code( bCmd, Cmd_Table[dwTmp].bCmd, &dwCmdLen );
			
			if( Is_Cmd_Match( pData, bCmd, dwCmdLen ) )
			{
				pDescript = Cmd_Table[dwTmp].bDLFchk;
				break;
			}
		}
		dwTmp++;
	}while( -1 != Cmd_Table[dwTmp].dwIndex );

EXIT_FIND_CMD_DESCRIP:
	
	if( NULL == pDescript )
		pDescript = ucUnknowDescription;
	else
		dwLastCmdIdx = dwTmp;
		
	return pDescript;
}

BOOL Is_Logging_Config_Cmd_Idx( DWORD dwIdx )
{
	BOOL bRet = FALSE;
	
	if( (dwIdx >= 23) && (dwIdx <= 27 ) )
		bRet = TRUE;
	
	return bRet;
}

UCHAR* Find_Rsp_Chksum( BYTE* pData, DWORD dwLen )
{
	UCHAR* pDescript = NULL;
	DWORD dwTmp = 0;
	DWORD dwThisCmdIdx = 0;
	

	if( dwLen > 777 || dwLen < 3 )
		goto EXIT_FIND_RSP_DESCRIP;

	///find in command table
	do{
		///handling Logging config Response...
		if( Is_Logging_Config_Cmd_Idx( dwLastCmdIdx ) )
		{
			dwTmp = dwLastCmdIdx;
			pDescript = Rsp_Table[dwTmp].bDLFchk;
			break;
		}else
		if( 19 == dwLastCmdIdx )
		{
			dwTmp = 40;
			pDescript = Rsp_Table[dwTmp].bDLFchk;
			break;
		}
		else
		if( 20 == dwLastCmdIdx )
		{
			dwTmp = 41;
			pDescript = Rsp_Table[dwTmp].bDLFchk;
			break;
		}
		else
		if( 13 == dwLastCmdIdx )
		{
			dwTmp = 42;
			pDescript = Rsp_Table[dwTmp].bDLFchk;
			break;
		}
		else
		if( 14 == dwLastCmdIdx )
		{
			dwTmp = 43;
			pDescript = Rsp_Table[dwTmp].bDLFchk;
			break;
		}
		else
			;

		///if( dwLen == Cmd_Table[dwTmp].dwCmdLen )
		if( dwLen >= Rsp_Table[dwTmp].dwRspLen )
		{
			///if( Is_Cmd_Match( pData, Cmd_Table[dwTmp].bCmd, dwLen ) )
			///if( Is_Rsp_Match( pData, Rsp_Table[dwTmp].bRsp, Rsp_Table[dwTmp].dwRspLen ) )
			///for DLF,  we already take ESC code off
			DWORD dwRspLen = 0;
			BYTE  bRsp[10];
			
			dwRspLen = Rsp_Table[dwTmp].dwRspLen;
			Copy_Stream_Without_ESC_code( bRsp, Rsp_Table[dwTmp].bRsp, &dwRspLen );

			if( Is_Rsp_Match( pData, bRsp, dwRspLen ) )
			{
				pDescript = Rsp_Table[dwTmp].bDLFchk;
				break;
			}
		}
		dwTmp++;
	}while( -1 != Rsp_Table[dwTmp].dwIndex );

EXIT_FIND_RSP_DESCRIP:
	
	if( NULL == pDescript )
		pDescript = ucUnknowDescription;
	else
		dwLastRspIdx = dwTmp;
		
	return pDescript;
}